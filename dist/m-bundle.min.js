!function(){"use strict";const n=n=>null!=n&&"object"==typeof n,e=e=>n(e)?Object.keys(e):[],t=(e,...o)=>!n(e)||o.length<1?{has:n(e)&&o.length<1,o:e,key:o[0]}:1===o.length?{has:Object.hasOwnProperty.call(e,o[0]),o:e,key:o[0]}:t(e[o.shift()],...o),o=(n,e,...o)=>{const i=t(e,...o);return i.o&&i.o[i.key]||n},i=n=>null==n||""===n,r=(n,e,t)=>i(n)?t:n+e+t,l=(n,e)=>"function"==typeof n&&(null==e||n.length===e),s=(()=>{let n,e;const t=t=>new Proxy(null!=t&&(e.has(t)?e.get(t):(n={},e.set(t,n),n)),{get:(n,e)=>n?n[e]:void 0,set:(n,e,t)=>n?n[e]=t:void 0});t.flush=(()=>{e=new WeakMap});t.flush();return t})(),c=(n,...e)=>{if(l(n))return n(...e)},u=(n,e)=>null!=n&&""!==n?n:e,f=function(n,e,t,o){if(!(null==n||arguments.length<3)){const[i,r]=t.split(":").reverse();if(3===arguments.length)return null==r?u(n.getAttribute(i),void 0):u(n.getAttributeNS(e[i],i),void 0);void 0===o?null==r?n.removeAttribute(i):n.removeAttributeNS(e[i],i):null==r?n.setAttribute(i,null==o?"":o):n.setAttributeNS(e[i],i,null==o?"":o)}};(n=>null!=n)(Array.prototype.flat)||(Array.prototype.flat=function(){return this.reduce((n,e)=>n.concat(e),[])});const a=function*(e){if(n(e))for(let n in e)"$"===n&&"object"!=typeof e.$?yield e.$:"$"!==n[0]&&"_"!==n[0]&&(yield n)};let d=class n{constructor(n,t,...i){let r;l(o(null,n,"view"))?(this.$=n,r=this):(this[n]={},r=this[n]),Object.assign(r,e(t).reduce((n,e)=>{n[e.replace(/^\$?/,"$")]=t[e];return n},{})),r._=i}};null==window.VNode?window.VNode=d:d=window.VNode,d.tag=(n=>{const e=a(n),t=e.next(),o=e.next();if(o.done)return t.value});d.attrs=function*(e,t){const o={};if(""===(e=e.replace(/\s*(?:#([^\s#\.[\]]+)|\.([^\s#\.[\]]+)|\[\s*([\w:]+[^\s=[\]]*)?(?:\s*=\s*(['"])?(.*?)\4)?\s*\])\s*/gi,(...n)=>{const[,e,t,i,,l,,]=n;null!=e?o.id=e:"string"==typeof t&&""!==t.trim()?o.class=r(o.class," ",t):null!=i&&(o[i]=void 0===l?null:l);return""}))&&(e="div"),yield e,n(t))for(let n in t)"$class"===n?"string"==typeof t.$class&&""!==t.$class.trim()&&(o.class=r(o.class," ",t.$class)):"$"===n[0]&&n.length>1&&(o[n.substr(1)]=t[n]);for(let n in o)yield{k:n,ev:"on"===n.substr(0,2)?n.substr(2):void 0,v:o[n]}},d.children=function*(e){if(null!=e)if(Array.isArray(e))for(const n of e)if(h.Component.isComponent(n))yield n;else for(const e of d.children(n))yield e;else if(n(e)){for(const n of a(e))yield Object.freeze({[n]:e[n]});for(const n of d.children(e._))yield n}else"string"!=typeof e&&"number"!=typeof e||(yield e)};let h=(e,...t)=>{const o={},i=[];for(let e,r=0;t.length>0;r++)e=t.shift(),0!==r||!n(e)||Array.isArray(e)||e instanceof d?Array.isArray(e)?i.splice(-1,0,...e):i.push(e):Object.assign(o,e);return new d(e,o,...i)};null==window.m?window.m=h:h=window.m,h.Component=class{constructor(n,e,...t){this.dom=null,this.static=n,this.attrs=e||{},this.children=t||[]}},h.Component.isComponent=(n=>l(o(null,n,"$","view"))),h.Component.instance=((n,e)=>({state:n,oninit(t){if(!0!==n.inited)return n.inited=!0,t.state=n,c(e.oninit,t)},oncreate(t){if(!0!==n.created)return n.created=!0,t.state=n,c(e.oncreate,t)},onbeforeupdate(t){return t.state=n,c(e.onbeforeupdate,t)},onupdate(t){return t.state=n,c(e.onupdate,t)},view(t){return t.state=n,c(e.view,t)},onbeforeremove(t){return t.state=n,c(e.onbeforeremove,t)},onremove(t){t.state=n;const o=c(e.onremove,t);for(const e in n)delete n[e];return o}}));for(name of["oninit","view","oncreate","onbeforeupdate","onupdate","onbeforeremove","onremove"]){const n=name;h.Component[n]=((e,t)=>{if(!l(e.static[n]))return;null!=t&&(e.dom=t);return e.static[n](e)})}h.root=null;const p=["","key","dirty"],m=(n,e,t=null)=>null==e?document.createTextNode(t):null!=n[""]?document.createElementNS(n[""],e):document.createElement(e),y=(n,e,t)=>{if(t===s(n)[e])return;n.removeEventListener(e,s(n)[e],!0);n.addEventListener(e,s(n)[e]=t,!0)},v={insertBefore:0,appendChild:1,recycleChild:2,removeChild:3};let C;const g=(e,t,i)=>{let r,l,c,u,a,b,w,k,N,$,A=[],x=new Set([]),S=-1;C=!1;const j=(n,e)=>{if(null==A||A.length<1)return;let t=[];for(const o of A)t.push(n(o,e));return t};const O=n=>{for(;h.Component.isComponent(n);){const e={},t=[],o=d.attrs("",n);o.next().value;for(const n of o)e[n.k]=n.v;for(const e of d.children(n))t.push(e);const i=new h.Component(n.$,e,...t);A.unshift(i),j(h.Component.oninit).some(n=>!1===n)?(C=!0,n=null):n=h.Component.view(i)}return n};const B=(n,e)=>{const t=A;A=n;j(h.Component.onbeforeremove);A=t;e();A=n;j(h.Component.onremove);A=t};const T=(n,e)=>{n(v.insertBefore,e);n(v.removeChild,e)};const E=(n,t)=>{switch(n){case v.insertBefore:case v.appendChild:r=v.insertBefore===n?e.insertBefore(m(i,a,l),t):e.appendChild(m(i,a,l));break;case v.recycleChild:if(null!=a){(r instanceof Text||(r.tagName||"").toUpperCase()!==a.toUpperCase())&&T(E,r);const n=new Set([]);for(w of r.getAttributeNames())n.add(w);for(w of b)p.includes(w.k)||(n.delete(w.k.split(":").pop()),null!=w.ev?y(r,w.ev,w.v):f(r,i,w.k)!==w.v&&f(r,i,w.k,w.v));for(w of n)f(r,i,w,void 0)}else r instanceof Text?r.data!==c&&(r.data=c):T(E,r);break;case v.removeChild:e.removeChild(t)}};t=O(t);let I=A.length;if(C)return;for(l of d.children(t)){for(A.splice(I),S++;x.has(S);)S++;if(l=O(l),C)return;if(n(l)?(a=d.tag(l),c=l[a]):(a=null,c=l),null!=a){b=d.attrs(a,c),i=Object.assign({},i);for(const n in c)"$xmlns"===n?i[""]=c[n]:/^\$xmlns:/.test(n)&&(i[n.substr(7)]=c[n]);a=b.next().value}else b=void 0;if(u=null!=a?o(null,c,"$key"):null,N=S,$=!1,null!=u){if(s(e.childNodes[S]).key===u)$=!0;else for(k=e.childNodes.length;!$&&k-- >0;)s(e.childNodes[k]).key===u&&(N=k,$=!0,S--);$||(E(v.insertBefore,e.childNodes[S]),s(e.childNodes[N]).key=u)}else null==e.childNodes[N]&&E(v.appendChild);if(x.add(N),(!$||!1!==o(null,c,"$dirty"))&&(r=e.childNodes[N],!1!==j(h.Component.onbeforeupdate)&&null==s(r).removing)){let e=[];const t=s(r).componentInstStack;if(null!=t)for(let n=t.length-1;n>=0;n--)if(null==A[n]||t[n].state!==A[n].state){e.push(t[n]);break}if(e.length>0?B(e,()=>{E(v.recycleChild)}):E(v.recycleChild),s(r).componentInstStack=A,n(l)&&(g(r,c,i),C))return;j(h.Component.oncreate,r),j(h.Component.onupdate,r)}}k=e.childNodes.length;for(;k-- >0;)r=e.childNodes[k],A=s(r).componentInstStack,x.has(k)||null!=s(r).removing||B(A,()=>{E(v.removeChild,r)})};let b,w,k;h.lastRenderTime=0;const N=n=>{h.renderCount++;w=performance.now();try{g(document.body,h.root)}catch(n){throw n}finally{k=performance.now(),h.lastRenderTime=k-w,b=null}};h.renderCount=0,h.redraw=(()=>{if(null!=b)return;b=1;N()}),h.untrusted=(n=>"string"==typeof n?n:"number"==typeof n?""+n:(console.error("Malicious value",n),""))}();
//# sourceMappingURL=m-bundle.min.js.map
